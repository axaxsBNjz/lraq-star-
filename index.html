<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Ø¹Ø±Ø§Ù‚ Ø³ØªØ§Ø± - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ</title>
    <style>
        :root {
            --primary: #1a2980;
            --secondary: #26d0ce;
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #f44336;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            min-height: 100vh;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .login-page {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            transition: all 0.5s ease;
            overflow-y: auto;
        }

        .login-container {
            background: white;
            width: 100%;
            max-width: 400px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: var(--primary);
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .login-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            -webkit-appearance: none;
            appearance: none;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 41, 128, 0.3);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: var(--dark);
            width: 100%;
            margin-top: 10px;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }

        .dashboard {
            display: none;
            min-height: 100vh;
            background: var(--light);
        }

        .sidebar {
            position: fixed;
            right: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .logo-section {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: var(--primary);
            font-weight: bold;
        }

        .nav-menu {
            list-style: none;
            padding: 20px 0;
        }

        .nav-item {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s;
            border-right: 4px solid transparent;
            display: flex;
            align-items: center;
            gap: 12px;
            touch-action: manipulation;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.1);
            border-right: 4px solid white;
        }

        .nav-item.active {
            background: rgba(255,255,255,0.15);
            border-right: 4px solid #FFD700;
        }

        .nav-icon {
            font-size: 20px;
        }

        .user-info {
            position: absolute;
            bottom: 80px;
            right: 0;
            left: 0;
            text-align: center;
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .logout-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            left: 20px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            touch-action: manipulation;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .main-content {
            margin-right: 250px;
            padding: 20px;
            min-height: 100vh;
            transition: margin 0.3s ease;
        }

        .top-bar {
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .control-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .control-btn.active {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }

        .grid-view {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .table-view {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
            -webkit-overflow-scrolling: touch;
        }

        .table-view table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .table-view th {
            background: var(--light);
            padding: 15px;
            text-align: right;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid #ddd;
        }

        .table-view td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: #555;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .action-btn.edit {
            background: #e3f2fd;
            color: #1565c0;
        }

        .action-btn.delete {
            background: #ffebee;
            color: #c62828;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 600px;
            border-radius: 15px;
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 30px;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .filter-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .customization-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .theme-selector {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #ddd;
            cursor: pointer;
            touch-action: manipulation;
        }

        .theme-btn.blue {
            background: linear-gradient(135deg, #1a2980, #26d0ce);
        }

        .theme-btn.green {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
        }

        .theme-btn.purple {
            background: linear-gradient(135deg, #6A1B9A, #9C27B0);
        }

        .theme-btn.dark {
            background: linear-gradient(135deg, #212121, #424242);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            border-top: 4px solid;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border-radius: 0 0 0 100%;
        }

        .stat-card.total { border-color: var(--primary); }
        .stat-card.active { border-color: var(--success); }
        .stat-card.pending { border-color: var(--warning); }
        .stat-card.revenue { border-color: var(--secondary); }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
            color: var(--primary);
        }

        .activity-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .activity-filters {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .activity-filter-btn {
            padding: 6px 12px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .activity-filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .activity-log {
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            -webkit-overflow-scrolling: touch;
        }

        .activity-item {
            padding: 15px;
            border-bottom: 1px solid #f5f5f5;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
        }

        .activity-item:hover {
            background: #f9f9f9;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .activity-icon.login { background: #e3f2fd; color: #1565c0; }
        .activity-icon.logout { background: #ffebee; color: #c62828; }
        .activity-icon.add { background: #e8f5e9; color: #2E7D32; }
        .activity-icon.edit { background: #fff3e0; color: #EF6C00; }
        .activity-icon.delete { background: #fce4ec; color: #C2185B; }
        .activity-icon.page { background: #f3e5f5; color: #7B1FA2; }

        .activity-details {
            flex: 1;
        }

        .activity-user {
            font-weight: bold;
            color: var(--dark);
        }

        .activity-action {
            color: #666;
            margin-top: 3px;
            font-size: 14px;
        }

        .activity-time {
            color: #999;
            font-size: 12px;
            direction: ltr;
            text-align: left;
            min-width: 120px;
        }

        .online-users {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .online-user-badge {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .online-indicator {
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(100%);
                width: 100%;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-right: 0;
                padding: 15px;
            }
            
            .menu-toggle {
                display: block !important;
            }
            
            .grid-view {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .control-btn {
                width: 100%;
            }
            
            .activity-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .activity-time {
                text-align: right;
                width: 100%;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .top-bar {
                padding: 12px 15px;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .control-panel {
                padding: 15px;
            }
            
            .modal-content {
                width: 95%;
                max-height: 85vh;
            }
            
            .modal-body {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .login-container {
                max-width: 90%;
                margin: 10px;
                border-radius: 15px;
            }
            
            .login-header {
                padding: 20px;
            }
            
            .login-logo {
                width: 60px;
                height: 60px;
                font-size: 30px;
            }
            
            .login-body {
                padding: 20px;
            }
            
            input, select, textarea {
                font-size: 16px !important;
                padding: 10px;
            }
            
            .btn {
                padding: 12px;
                font-size: 14px;
            }
            
            .nav-item {
                padding: 12px 20px;
            }
            
            .control-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .filter-section {
                justify-content: center;
            }
            
            .filter-btn {
                padding: 6px 12px;
                font-size: 14px;
            }
        }

        /* Ù…Ù†Ø¹ zoom Ø¹Ù„Ù‰ input ÙÙŠ iOS */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            color: var(--primary);
            cursor: pointer;
            touch-action: manipulation;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(38, 208, 206, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(38, 208, 206, 0); }
            100% { box-shadow: 0 0 0 0 rgba(38, 208, 206, 0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .progress-bar {
            height: 6px;
            background: #eee;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            width: 0%;
            transition: width 1s ease;
        }

        .badge {
            background: #4CAF50;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            display: inline-block;
        }

        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .user-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .user-role {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            margin-top: 10px;
        }

        .role-admin { background: #2196F3; color: white; }
        .role-editor { background: #4CAF50; color: white; }
        .role-viewer { background: #FF9800; color: white; }

        .activity-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .activity-stat-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .activity-stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            margin: 5px 0;
        }

        .activity-stat-label {
            font-size: 12px;
            color: #666;
        }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ */
        .alert-message {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 10000;
            animation: slideIn 0.3s ease-out;
            color: white;
            font-weight: 600;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ© */
        @media (min-width: 769px) and (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }
            
            .main-content {
                margin-right: 220px;
            }
            
            .grid-view {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ØªØ¬Ø±Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ */
        .touch-feedback {
            transition: transform 0.2s;
        }

        .touch-feedback:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div class="login-page" id="loginPage">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">Ø¹</div>
                <h1>Ø¹Ø±Ø§Ù‚ Ø³ØªØ§Ø±</h1>
                <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</p>
            </div>
            
            <div class="login-body">
                <div class="error-message" id="loginError"></div>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                        <input type="text" id="username" required autocomplete="username">
                    </div>
                    
                    <div class="form-group">
                        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="password" required autocomplete="current-password">
                    </div>
                    
                    <button type="submit" class="btn btn-primary touch-feedback">
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="sidebar" id="sidebar">
            <div class="logo-section">
                <div class="logo">Ø¹</div>
                <h3>Ø¹Ø±Ø§Ù‚ Ø³ØªØ§Ø±</h3>
                <p style="font-size: 12px; opacity: 0.8;">Ù†Ø¸Ø§Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ù…ØªÙƒØ§Ù…Ù„</p>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item active touch-feedback" data-page="dashboard">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                </li>
                <li class="nav-item touch-feedback" data-page="activity">
                    <span class="nav-icon">ğŸ‘ï¸</span>
                    <span>Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                </li>
                <li class="nav-item touch-feedback" data-page="subscribers">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</span>
                </li>
                <li class="nav-item touch-feedback" data-page="services">
                    <span class="nav-icon">ğŸ› ï¸</span>
                    <span>Ø§Ù„Ø®Ø¯Ù…Ø§Øª</span>
                </li>
                <li class="nav-item touch-feedback" data-page="financial">
                    <span class="nav-icon">ğŸ’°</span>
                    <span>Ø§Ù„Ù…Ø§Ù„ÙŠØ©</span>
                </li>
                <li class="nav-item touch-feedback" data-page="users">
                    <span class="nav-icon">ğŸ‘¨â€ğŸ’¼</span>
                    <span>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                </li>
                <li class="nav-item touch-feedback" data-page="settings">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                </li>
            </ul>
            
            <div class="user-info">
                <div style="font-size: 14px; opacity: 0.9;">Ù…Ø³ØªØ®Ø¯Ù…</div>
                <div id="currentUser" style="font-weight: bold; margin-top: 5px;">...</div>
                <div id="currentRole" style="font-size: 12px; opacity: 0.8; margin-top: 5px;"></div>
                <div id="loginTime" style="font-size: 11px; color: #4CAF50; margin-top: 5px;"></div>
            </div>
            
            <button class="logout-btn touch-feedback" id="logoutBtn">
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
        </div>

        <div class="main-content">
            <div class="top-bar">
                <button class="menu-toggle touch-feedback" id="menuToggle">
                    â˜°
                </button>
                <h1 id="pageTitle">Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h1>
                <div style="display: flex; gap: 15px; align-items: center;">
                    <div id="currentDate" style="color: #666;"></div>
                    <div id="onlineStatus" style="display: flex; align-items: center; gap: 5px; color: var(--success);">
                        <span style="width: 10px; height: 10px; background: var(--success); border-radius: 50%;"></span>
                        <span>Ù…ØªØµÙ„</span>
                    </div>
                </div>
            </div>

            <div class="control-panel">
                <div class="control-header">
                    <h2>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ</h2>
                    <div class="control-buttons">
                        <button class="control-btn active touch-feedback" onclick="setViewMode('grid')">Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</button>
                        <button class="control-btn touch-feedback" onclick="setViewMode('table')">Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
                        <button class="control-btn touch-feedback" onclick="refreshData()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                        <button class="control-btn touch-feedback" onclick="exportAllData()">ØªØµØ¯ÙŠØ± Ø§Ù„ÙƒÙ„</button>
                    </div>
                </div>
                
                <div class="search-box">
                    <input type="text" id="globalSearch" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£ÙŠ Ø´ÙŠØ¡..." oninput="performSearch(this.value)">
                </div>
                
                <div class="filter-section">
                    <button class="filter-btn active touch-feedback" onclick="filterData('all')">Ø§Ù„ÙƒÙ„</button>
                    <button class="filter-btn touch-feedback" onclick="filterData('active')">Ù†Ø´Ø·</button>
                    <button class="filter-btn touch-feedback" onclick="filterData('pending')">Ù…Ø¹Ù„Ù‚</button>
                    <button class="filter-btn touch-feedback" onclick="filterData('inactive')">Ù…ØªÙˆÙ‚Ù</button>
                </div>
            </div>

            <div id="pageContent">
                <div class="page active" id="dashboardPage">
                    <div class="stats-grid">
                        <div class="stat-card total">
                            <div style="font-size: 24px; color: var(--primary); margin-bottom: 10px;">ğŸ‘¥</div>
                            <div class="stat-value" id="totalCount">0</div>
                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</div>
                            <div class="progress-bar">
                                <div class="progress" id="totalProgress"></div>
                            </div>
                        </div>
                        
                        <div class="stat-card active">
                            <div style="font-size: 24px; color: var(--success); margin-bottom: 10px;">âœ…</div>
                            <div class="stat-value" id="activeCount">0</div>
                            <div class="stat-label">Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù†Ø´Ø·ÙŠÙ†</div>
                            <div class="progress-bar">
                                <div class="progress" id="activeProgress"></div>
                            </div>
                        </div>
                        
                        <div class="stat-card pending">
                            <div style="font-size: 24px; color: var(--warning); margin-bottom: 10px;">â³</div>
                            <div class="stat-value" id="pendingCount">0</div>
                            <div class="stat-label">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¯ÙØ¹</div>
                            <div class="progress-bar">
                                <div class="progress" id="pendingProgress"></div>
                            </div>
                        </div>
                        
                        <div class="stat-card revenue">
                            <div style="font-size: 24px; color: var(--secondary); margin-bottom: 10px;">ğŸ’°</div>
                            <div class="stat-value" id="revenueCount">0 Ø¯ÙŠÙ†Ø§Ø±</div>
                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                            <div class="progress-bar">
                                <div class="progress" id="revenueProgress"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="dynamicView">
                    </div>
                </div>

                <div class="page" id="activityPage">
                    <div class="customization-panel">
                        <h3>ğŸ‘ï¸ Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                        <p style="color: #666; margin-top: 10px;">ØªØ§Ø¨Ø¹ ÙƒÙ„ ØªØ­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                    </div>
                    
                    <div class="activity-stats">
                        <div class="activity-stat-card">
                            <div style="font-size: 20px; color: var(--primary);">ğŸ‘¥</div>
                            <div class="activity-stat-value" id="totalUsers">0</div>
                            <div class="activity-stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
                        </div>
                        
                        <div class="activity-stat-card">
                            <div style="font-size: 20px; color: var(--success);">âœ…</div>
                            <div class="activity-stat-value" id="onlineUsers">0</div>
                            <div class="activity-stat-label">Ù…ØªØµÙ„ÙˆÙ† Ø§Ù„Ø¢Ù†</div>
                        </div>
                        
                        <div class="activity-stat-card">
                            <div style="font-size: 20px; color: var(--warning);">ğŸ“Š</div>
                            <div class="activity-stat-value" id="todayActivities">0</div>
                            <div class="activity-stat-label">Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                        </div>
                        
                        <div class="activity-stat-card">
                            <div style="font-size: 20px; color: var(--danger);">âš¡</div>
                            <div class="activity-stat-value" id="lastHourActivities">0</div>
                            <div class="activity-stat-label">Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª (Ø¢Ø®Ø± Ø³Ø§Ø¹Ø©)</div>
                        </div>
                    </div>
                    
                    <div class="customization-panel">
                        <h4>ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</h4>
                        <div class="online-users" id="onlineUsersList">
                        </div>
                    </div>
                    
                    <div class="activity-panel">
                        <div class="control-header">
                            <h3>ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</h3>
                            <div class="activity-filters">
                                <button class="activity-filter-btn active touch-feedback" onclick="filterActivity('all')">Ø§Ù„ÙƒÙ„</button>
                                <button class="activity-filter-btn touch-feedback" onclick="filterActivity('login')">ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø¯Ø®ÙˆÙ„</button>
                                <button class="activity-filter-btn touch-feedback" onclick="filterActivity('logout')">ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø®Ø±ÙˆØ¬</button>
                                <button class="activity-filter-btn touch-feedback" onclick="filterActivity('add')">Ø¥Ø¶Ø§ÙØ§Øª</button>
                                <button class="activity-filter-btn touch-feedback" onclick="filterActivity('edit')">ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
                                <button class="activity-filter-btn touch-feedback" onclick="filterActivity('delete')">Ø­Ø°Ù</button>
                                <button class="activity-filter-btn touch-feedback" onclick="filterActivity('page')">ØªØµÙØ­ Ø§Ù„ØµÙØ­Ø§Øª</button>
                            </div>
                        </div>
                        
                        <div class="activity-log" id="activityLog">
                        </div>
                    </div>
                </div>

                <div class="page" id="subscribersPage">
                    <div class="customization-panel">
                        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</h3>
                        <button class="btn btn-primary touch-feedback" onclick="openAddModal()" style="margin-top: 15px;" id="addSubscriberBtn">
                            + Ø¥Ø¶Ø§ÙØ© Ù…Ø´ØªØ±Ùƒ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                    
                    <div id="subscribersView">
                    </div>
                </div>

                <div class="page" id="servicesPage">
                    <div class="customization-panel">
                        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</h3>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-primary touch-feedback" onclick="openServiceModal()" id="addServiceBtn">
                                + Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
                            </button>
                        </div>
                    </div>
                    
                    <div id="servicesView">
                    </div>
                </div>

                <div class="page" id="financialPage">
                    <div class="customization-panel">
                        <h3>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</h3>
                    </div>
                    
                    <div id="financialView">
                    </div>
                </div>

                <div class="page" id="usersPage">
                    <div class="customization-panel">
                        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                        <button class="btn btn-primary touch-feedback" onclick="openUserModal()" style="margin-top: 15px;" id="addUserBtn">
                            + Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                    
                    <div id="usersView">
                    </div>
                </div>

                <div class="page" id="settingsPage">
                    <div class="customization-panel">
                        <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØªØ®ØµÙŠØµ</h3>
                        
                        <div style="margin-top: 20px;">
                            <h4 style="margin-bottom: 15px;">ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ…</h4>
                            <div class="theme-selector">
                                <button class="theme-btn blue touch-feedback" onclick="changeTheme('blue')"></button>
                                <button class="theme-btn green touch-feedback" onclick="changeTheme('green')"></button>
                                <button class="theme-btn purple touch-feedback" onclick="changeTheme('purple')"></button>
                                <button class="theme-btn dark touch-feedback" onclick="changeTheme('dark')"></button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <h4 style="margin-bottom: 15px;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø±Ø¶</h4>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="checkbox" id="autoRefresh" checked onchange="saveSetting('autoRefresh', this.checked)">
                                    <span>Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="checkbox" id="notifications" checked onchange="saveSetting('notifications', this.checked)">
                                    <span>Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="checkbox" id="logActivities" checked onchange="saveSetting('logActivities', this.checked)">
                                    <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</span>
                                </label>
                            </div>
                        </div>

                        <div style="margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px;">
                            <h4 style="margin-bottom: 15px;">Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ</h4>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-primary touch-feedback" onclick="backupData()">
                                    ğŸ“¥ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                                </button>
                                <button class="btn btn-secondary touch-feedback" onclick="restoreData()">
                                    ğŸ“¤ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù†Ø³Ø®Ø©
                                </button>
                            </div>
                        </div>

                        <div style="margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px;">
                            <h4 style="margin-bottom: 15px;">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h4>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn btn-secondary touch-feedback" onclick="exportActivityLog()">
                                    ğŸ“„ ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª
                                </button>
                                <button class="btn btn-secondary touch-feedback" onclick="clearOldActivities()">
                                    ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="addModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ø´ØªØ±Ùƒ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="close-modal touch-feedback" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addForm">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                            <input type="text" id="nameInput" required>
                        </div>
                        <div>
                            <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <input type="tel" id="phoneInput" required>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="emailInput">
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div>
                            <label>Ø§Ù„Ø®Ø¯Ù…Ø©</label>
                            <select id="serviceInput" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø©</option>
                            </select>
                        </div>
                        <div>
                            <label>Ø§Ù„Ø³Ø¹Ø± (Ø¯ÙŠÙ†Ø§Ø±)</label>
                            <input type="number" id="priceInput" required>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div>
                            <label>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
                            <select id="governorateInput" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
                            </select>
                        </div>
                        <div>
                            <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
                            <select id="statusInput" required>
                                <option value="active">Ù†Ø´Ø·</option>
                                <option value="pending">Ù…Ø¹Ù„Ù‚</option>
                                <option value="inactive">Ù…ØªÙˆÙ‚Ù</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <textarea id="notesInput" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; height: 80px;"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 25px;">
                        <button type="submit" class="btn btn-primary touch-feedback" style="flex: 1;">Ø­ÙØ¸</button>
                        <button type="button" class="btn btn-secondary touch-feedback" onclick="closeModal()" style="flex: 1;">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
                <button class="close-modal touch-feedback" onclick="closeUserModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                            <input type="text" id="userNameInput" required>
                        </div>
                        <div>
                            <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                            <input type="password" id="userPasswordInput" required>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                            <input type="text" id="userFullNameInput" required>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label>Ø§Ù„Ø¯ÙˆØ±</label>
                        <select id="userRoleInput" required>
                            <option value="admin">Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</option>
                            <option value="editor">Ù…Ø­Ø±Ø±</option>
                            <option value="viewer">Ù…Ø´Ø§Ù‡Ø¯</option>
                        </select>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="userEmailInput">
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 25px;">
                        <button type="submit" class="btn btn-primary touch-feedback" style="flex: 1;">Ø­ÙØ¸</button>
                        <button type="button" class="btn btn-secondary touch-feedback" onclick="closeUserModal()" style="flex: 1;">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal" id="serviceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="serviceModalTitle">Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <button class="close-modal touch-feedback" onclick="closeServiceModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="serviceForm">
                    <div>
                        <label>Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©</label>
                        <input type="text" id="serviceNameInput" required>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label>Ø§Ù„ÙØ¦Ø©</label>
                        <select id="serviceCategoryInput" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø©</option>
                            <option value="ØªØ·ÙˆÙŠØ±">ØªØ·ÙˆÙŠØ±</option>
                            <option value="ØªØµÙ…ÙŠÙ…">ØªØµÙ…ÙŠÙ…</option>
                            <option value="Ø§Ø³ØªØ¶Ø§ÙØ©">Ø§Ø³ØªØ¶Ø§ÙØ©</option>
                            <option value="ØªØ³ÙˆÙŠÙ‚">ØªØ³ÙˆÙŠÙ‚</option>
                        </select>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div>
                            <label>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø¯Ù†Ù‰ (Ø¯ÙŠÙ†Ø§Ø±)</label>
                            <input type="number" id="serviceMinPrice" required>
                        </div>
                        <div>
                            <label>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ù‚ØµÙ‰ (Ø¯ÙŠÙ†Ø§Ø±)</label>
                            <input type="number" id="serviceMaxPrice" required>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label>ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø©</label>
                        <textarea id="serviceDescription" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; height: 100px;"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 25px;">
                        <button type="submit" class="btn btn-primary touch-feedback" style="flex: 1;">Ø­ÙØ¸</button>
                        <button type="button" class="btn btn-secondary touch-feedback" onclick="closeServiceModal()" style="flex: 1;">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        class DynamicManager {
            constructor() {
                this.users = this.loadData('users') || this.getDefaultUsers();
                this.subscribers = this.loadData('subscribers') || [];
                this.services = this.loadData('services') || this.getDefaultServices();
                this.financialData = this.loadData('financial') || [];
                this.settings = this.loadData('settings') || this.getDefaultSettings();
                this.activityLog = this.loadData('activityLog') || [];
                this.onlineUsers = this.loadData('onlineUsers') || [];
                
                this.currentView = 'grid';
                this.currentFilter = 'all';
                this.currentTheme = this.settings.theme || 'blue';
                this.editingId = null;
                this.currentUser = null;
                this.userLoginTime = null;
                this.currentActivityFilter = 'all';
                
                this.initialize();
            }

            initialize() {
                this.setupEventListeners();
                this.updateDate();
                this.applyTheme();
                this.setupRealTimeUpdates();
                this.checkLogin();
                this.disableZoom();
            }

            setupEventListeners() {
                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleLogin();
                });

                document.getElementById('logoutBtn').addEventListener('click', () => this.logout());

                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', () => {
                        if (this.currentUser) {
                            const page = item.getAttribute('data-page');
                            this.switchPage(page);
                        }
                    });
                });

                document.getElementById('menuToggle').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.toggle('active');
                });

                document.getElementById('addForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveSubscriber();
                });

                document.getElementById('userForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveUser();
                });

                document.getElementById('serviceForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveService();
                });

                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
                document.addEventListener('click', (e) => {
                    const sidebar = document.getElementById('sidebar');
                    const menuToggle = document.getElementById('menuToggle');
                    
                    if (window.innerWidth <= 768 && 
                        sidebar.classList.contains('active') &&
                        !sidebar.contains(e.target) && 
                        e.target !== menuToggle) {
                        sidebar.classList.remove('active');
                    }
                });

                // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                setInterval(() => {
                    if (this.settings.autoRefresh && this.currentUser) {
                        this.renderAll();
                    }
                }, 30000);

                // ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
                window.addEventListener('online', () => this.updateOnlineStatus());
                window.addEventListener('offline', () => this.updateOnlineStatus());

                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
                window.addEventListener('beforeunload', () => {
                    if (this.currentUser) {
                        this.logoutActivity('Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©', true);
                    }
                });

                // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù„Ù…Ø³
                this.setupTouchEvents();
            }

            setupTouchEvents() {
                // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù„Ù…Ø³ Ù„Ù„Ø£Ø²Ø±Ø§Ø±
                document.querySelectorAll('.touch-feedback').forEach(button => {
                    button.addEventListener('touchstart', function() {
                        this.classList.add('active');
                    });
                    
                    button.addEventListener('touchend', function() {
                        this.classList.remove('active');
                    });
                });

                // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø£ÙÙ‚ÙŠ ØºÙŠØ± Ø§Ù„Ù…Ù‚ØµÙˆØ¯
                document.addEventListener('touchmove', function(e) {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                        return;
                    }
                }, { passive: false });
            }

            disableZoom() {
                // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ±/Ø§Ù„ØªØµØºÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
                document.addEventListener('gesturestart', function(e) {
                    e.preventDefault();
                });

                document.addEventListener('touchmove', function(e) {
                    if (e.scale !== 1) {
                        e.preventDefault();
                    }
                }, { passive: false });
            }

            setupRealTimeUpdates() {
                setInterval(() => {
                    this.updateDate();
                    this.updateLoginTimeDisplay();
                }, 60000);

                setInterval(() => {
                    this.updateOnlineUsers();
                }, 10000);
            }

            getDefaultUsers() {
                return [
                    {
                        id: 1,
                        username: 'admin',
                        password: 'admin123',
                        fullName: 'Ø§Ù„Ø£Ø³Ù€ØªØ§Ø° Ø­Ø³ÙŠÙ† Ø§Ù„Ø²Ø¨ÙŠØ¯ÙŠ',
                        role: 'admin',
                        email: 'admin@iraqstar.iq',
                        created: new Date().toISOString(),
                        lastLogin: null,
                        ipAddress: '127.0.0.1'
                    }
                ];
            }

            getDefaultServices() {
                return [
                    { id: 1, name: "Ø¨Ø±Ù…Ø¬Ø© Ù…ÙˆØ§Ù‚Ø¹", priceRange: "200,000 - 1,000,000", category: "ØªØ·ÙˆÙŠØ±", description: "ØªØµÙ…ÙŠÙ… ÙˆØ¨Ø±Ù…Ø¬Ø© Ù…ÙˆØ§Ù‚Ø¹ Ø§Ø­ØªØ±Ø§ÙÙŠØ©" },
                    { id: 2, name: "ØªØµÙ…ÙŠÙ… Ø¬Ø±Ø§ÙÙŠÙƒ", priceRange: "50,000 - 200,000", category: "ØªØµÙ…ÙŠÙ…", description: "ØªØµÙ…ÙŠÙ… Ø´Ø¹Ø§Ø±Ø§Øª ÙˆÙ…ÙˆØ§Ø¯ Ø¯Ø¹Ø§Ø¦ÙŠØ©" },
                    { id: 3, name: "Ø§Ø³ØªØ¶Ø§ÙØ© Ù…ÙˆØ§Ù‚Ø¹", priceRange: "50,000 - 500,000", category: "Ø§Ø³ØªØ¶Ø§ÙØ©", description: "Ø§Ø³ØªØ¶Ø§ÙØ© Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø¹ Ø¯Ø¹Ù… ÙÙ†ÙŠ" },
                    { id: 4, name: "ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚Ø§Øª", priceRange: "500,000 - 5,000,000", category: "ØªØ·ÙˆÙŠØ±", description: "ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ³Ø·Ø­ Ù…ÙƒØªØ¨" }
                ];
            }

            getDefaultSettings() {
                return {
                    theme: 'blue',
                    autoRefresh: true,
                    notifications: true,
                    logActivities: true
                };
            }

            loadData(key) {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (error) {
                    console.error(`Error loading ${key}:`, error);
                    return null;
                }
            }

            saveData(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                } catch (error) {
                    console.error(`Error saving ${key}:`, error);
                }
            }

            handleLogin() {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value;
                
                if (!username || !password) {
                    this.showError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                    return;
                }
                
                const user = this.users.find(u => 
                    u.username.toLowerCase() === username.toLowerCase() && 
                    u.password === password
                );
                
                if (user) {
                    this.currentUser = user;
                    this.userLoginTime = new Date();
                    
                    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©
                    try {
                        localStorage.setItem('currentUser', JSON.stringify(user));
                    } catch (e) {
                        console.error('Error saving session:', e);
                    }
                    
                    // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„
                    user.lastLogin = new Date().toISOString();
                    this.saveData('users', this.users);
                    
                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø·
                    this.logActivity('login', `Ù‚Ø§Ù… ${user.fullName} Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…`);
                    this.addOnlineUser(user);
                    
                    // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                    this.showDashboard();
                    this.showMessage('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    document.getElementById('loginForm').reset();
                } else {
                    this.showError('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                    document.getElementById('password').value = '';
                    document.getElementById('password').focus();
                }
            }

            checkLogin() {
                try {
                    const savedUser = localStorage.getItem('currentUser');
                    if (savedUser) {
                        this.currentUser = JSON.parse(savedUser);
                        const userExists = this.users.some(u => u.id === this.currentUser.id);
                        
                        if (userExists) {
                            this.userLoginTime = new Date();
                            this.addOnlineUser(this.currentUser);
                            this.logActivity('login', `Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¬Ù„Ø³Ø© ${this.currentUser.fullName}`);
                            this.showDashboard();
                        } else {
                            localStorage.removeItem('currentUser');
                            this.currentUser = null;
                        }
                    }
                } catch (error) {
                    localStorage.removeItem('currentUser');
                    this.currentUser = null;
                }
            }

            logout() {
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                    if (this.currentUser) {
                        const sessionDuration = Math.floor((new Date() - this.userLoginTime) / 1000);
                        this.logActivity('logout', `Ù‚Ø§Ù… ${this.currentUser.fullName} Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… (Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø©: ${this.formatDuration(sessionDuration)})`);
                        this.removeOnlineUser(this.currentUser.id);
                    }
                    
                    this.currentUser = null;
                    try {
                        localStorage.removeItem('currentUser');
                    } catch (e) {
                        console.error('Error clearing session:', e);
                    }
                    
                    document.getElementById('dashboard').style.display = 'none';
                    document.getElementById('loginPage').style.display = 'flex';
                    document.getElementById('username').value = '';
                    document.getElementById('password').value = '';
                    this.showMessage('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'success');
                    
                    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
                    if (window.innerWidth <= 768) {
                        document.getElementById('sidebar').classList.remove('active');
                    }
                }
            }

            logoutActivity(reason = 'Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©', silent = false) {
                if (this.currentUser) {
                    const sessionDuration = Math.floor((new Date() - this.userLoginTime) / 1000);
                    this.logActivity('logout', `${this.currentUser.fullName} - ${reason} (Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø©: ${this.formatDuration(sessionDuration)})`);
                    this.removeOnlineUser(this.currentUser.id);
                }
            }

            formatDuration(seconds) {
                if (seconds < 60) {
                    return `${seconds} Ø«Ø§Ù†ÙŠØ©`;
                } else if (seconds < 3600) {
                    const minutes = Math.floor(seconds / 60);
                    return `${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
                } else {
                    const hours = Math.floor(seconds / 3600);
                    const minutes = Math.floor((seconds % 3600) / 60);
                    return `${hours} Ø³Ø§Ø¹Ø© ${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
                }
            }

            showDashboard() {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                document.getElementById('currentUser').textContent = this.currentUser.fullName;
                document.getElementById('currentRole').textContent = this.getRoleText(this.currentUser.role);
                this.updateLoginTimeDisplay();
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                this.checkPermissions();
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                this.renderAll();
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
                if (window.innerWidth <= 768) {
                    document.getElementById('sidebar').classList.remove('active');
                }
            }

            updateLoginTimeDisplay() {
                if (this.userLoginTime) {
                    const now = new Date();
                    const diffMs = now - this.userLoginTime;
                    const diffMins = Math.floor(diffMs / 60000);
                    
                    let timeText;
                    if (diffMins < 1) {
                        timeText = 'Ø§Ù„Ø¢Ù†';
                    } else if (diffMins < 60) {
                        timeText = `Ù‚Ø¨Ù„ ${diffMins} Ø¯Ù‚ÙŠÙ‚Ø©`;
                    } else {
                        const diffHours = Math.floor(diffMins / 60);
                        timeText = `Ù‚Ø¨Ù„ ${diffHours} Ø³Ø§Ø¹Ø©`;
                    }
                    
                    document.getElementById('loginTime').textContent = `ğŸ•’ Ù…ØªØµÙ„ Ù…Ù†Ø°: ${timeText}`;
                }
            }

            getRoleText(role) {
                const roles = {
                    'admin': 'Ù…Ø·ÙˆØ± Ø§Ù„Ù†Ø¸Ø§Ù…',
                    'editor': 'Ø§Ø¯Ù…Ù†',
                    'viewer': 'Ø²Ø¨ÙˆÙ†'
                };
                return roles[role] || 'Ù…Ø³ØªØ®Ø¯Ù…';
            }

            checkPermissions() {
                const isAdmin = this.currentUser.role === 'admin';
                const isEditor = this.currentUser.role === 'editor' || isAdmin;
                
                // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                document.querySelectorAll('.nav-item[data-page="activity"]').forEach(item => {
                    item.style.display = isEditor ? 'flex' : 'none';
                });
                
                document.querySelectorAll('.nav-item[data-page="users"]').forEach(item => {
                    item.style.display = isAdmin ? 'flex' : 'none';
                });
                
                document.getElementById('addUserBtn').style.display = isAdmin ? 'block' : 'none';
                document.getElementById('addSubscriberBtn').style.display = isEditor ? 'block' : 'none';
                document.getElementById('addServiceBtn').style.display = isEditor ? 'block' : 'none';
            }

            showError(message) {
                const errorDiv = document.getElementById('loginError');
                errorDiv.textContent = message;
                errorDiv.style.cssText = `
                    display: block;
                    background: #ffebee;
                    color: #c62828;
                    padding: 15px;
                    border-radius: 8px;
                    margin-bottom: 20px;
                    text-align: center;
                    font-size: 14px;
                    animation: shake 0.5s;
                `;
                
                // Ø¥Ø¶Ø§ÙØ© animation Ù„Ù„Ù‡Ø²
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes shake {
                        0%, 100% { transform: translateX(0); }
                        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                        20%, 40%, 60%, 80% { transform: translateX(5px); }
                    }
                `;
                document.head.appendChild(style);
                
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 5000);
            }

            logActivity(type, action, details = {}) {
                if (!this.settings.logActivities) return;
                
                const activity = {
                    id: Date.now(),
                    userId: this.currentUser ? this.currentUser.id : null,
                    userName: this.currentUser ? this.currentUser.fullName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                    userRole: this.currentUser ? this.currentUser.role : 'unknown',
                    type: type,
                    action: action,
                    details: details,
                    timestamp: new Date().toISOString(),
                    ip: '127.0.0.1',
                    browser: navigator.userAgent,
                    page: window.location.href
                };
                
                this.activityLog.unshift(activity);
                
                // Ø­ÙØ¸ ÙÙ‚Ø· Ø¢Ø®Ø± 1000 Ù†Ø´Ø§Ø·
                if (this.activityLog.length > 1000) {
                    this.activityLog = this.activityLog.slice(0, 1000);
                }
                
                this.saveData('activityLog', this.activityLog);
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙØ­Ø© Ù…ÙØªÙˆØ­Ø©
                if (document.getElementById('activityPage').classList.contains('active')) {
                    this.renderActivityLog();
                    this.updateActivityStats();
                }
            }

            addOnlineUser(user) {
                const existingUser = this.onlineUsers.find(u => u.id === user.id);
                
                if (!existingUser) {
                    const onlineUser = {
                        id: user.id,
                        name: user.fullName,
                        role: user.role,
                        loginTime: new Date().toISOString(),
                        lastActivity: new Date().toISOString()
                    };
                    
                    this.onlineUsers.push(onlineUser);
                    this.saveData('onlineUsers', this.onlineUsers);
                }
            }

            removeOnlineUser(userId) {
                this.onlineUsers = this.onlineUsers.filter(u => u.id !== userId);
                this.saveData('onlineUsers', this.onlineUsers);
            }

            updateOnlineUsers() {
                const now = new Date();
                
                // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± Ù†Ø´Ø§Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
                if (this.currentUser) {
                    const userIndex = this.onlineUsers.findIndex(u => u.id === this.currentUser.id);
                    if (userIndex !== -1) {
                        this.onlineUsers[userIndex].lastActivity = now.toISOString();
                    }
                }
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ØºÙŠØ± Ø§Ù„Ù†Ø´Ø·ÙŠÙ† Ù„Ø£ÙƒØ«Ø± Ù…Ù† 5 Ø¯Ù‚Ø§Ø¦Ù‚
                const fiveMinutesAgo = new Date(now.getTime() - 5 * 60000);
                this.onlineUsers = this.onlineUsers.filter(user => {
                    return new Date(user.lastActivity) > fiveMinutesAgo;
                });
                
                this.saveData('onlineUsers', this.onlineUsers);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…ÙØªÙˆØ­Ø©
                if (document.getElementById('activityPage').classList.contains('active')) {
                    this.renderOnlineUsers();
                    this.updateActivityStats();
                }
            }

            switchPage(page) {
                // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
                document.querySelectorAll('.page').forEach(p => {
                    p.classList.remove('active');
                    p.style.display = 'none';
                });
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                const targetPage = document.getElementById(page + 'Page');
                targetPage.classList.add('active');
                targetPage.style.display = 'block';
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
                const titles = {
                    'dashboard': 'Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                    'activity': 'Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
                    'subscribers': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†',
                    'services': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª',
                    'financial': 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
                    'users': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
                    'settings': 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª'
                };
                document.getElementById('pageTitle').textContent = titles[page];
                
                // ØªØ³Ø¬ÙŠÙ„ Ù†Ø´Ø§Ø· ØªØµÙØ­ Ø§Ù„ØµÙØ­Ø©
                if (this.currentUser && page !== 'dashboard') {
                    this.logActivity('page', `ØªØµÙØ­ ØµÙØ­Ø© ${titles[page]}`, { page: page });
                }
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø©
                switch(page) {
                    case 'activity':
                        this.renderActivityPage();
                        break;
                    case 'subscribers':
                        this.renderSubscribers();
                        break;
                    case 'services':
                        this.renderServices();
                        break;
                    case 'financial':
                        this.renderFinancial();
                        break;
                    case 'users':
                        this.renderUsers();
                        break;
                    case 'settings':
                        this.renderSettings();
                        break;
                    default:
                        this.renderDashboard();
                }

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-page') === page) {
                        item.classList.add('active');
                    }
                });

                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
                if (window.innerWidth <= 768) {
                    document.getElementById('sidebar').classList.remove('active');
                }
            }

            generateDemoData() {
                const names = ["Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ", "Ù…Ø­Ù…Ø¯ Ø­Ø³Ù†", "Ø³Ø§Ù„Ù… ÙƒØ±ÙŠÙ…", "Ø¹Ù„ÙŠ Ù…Ø­Ù…ÙˆØ¯", "Ø­Ø³ÙŠÙ† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", "Ø²ÙŠØ¯ Ø¹Ù…Ø±", "Ø®Ø§Ù„Ø¯ Ø³Ø¹ÙŠØ¯", "Ø¹Ù…Ø± Ø±Ø§Ø´Ø¯"];
                const services = ["Ø¨Ø±Ù…Ø¬Ø© Ù…ÙˆØ§Ù‚Ø¹", "ØªØµÙ…ÙŠÙ… Ø¬Ø±Ø§ÙÙŠÙƒ", "Ø§Ø³ØªØ¶Ø§ÙØ© Ù…ÙˆØ§Ù‚Ø¹", "ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚Ø§Øª"];
                const statuses = ['active', 'pending', 'inactive'];
                
                return names.map((name, index) => ({
                    id: index + 1,
                    name: name,
                    service: services[Math.floor(Math.random() * services.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    price: Math.floor(Math.random() * 1000000) + 50000,
                    progress: Math.floor(Math.random() * 100)
                }));
            }

            renderDashboard() {
                let html = '';
                const demoData = this.generateDemoData();
                
                if (this.currentView === 'grid') {
                    html = '<div class="grid-view">';
                    demoData.forEach(item => {
                        html += `
                            <div class="card fade-in touch-feedback">
                                <h4>${item.name}</h4>
                                <p>${item.service}</p>
                                <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                                    <span class="badge" style="
                                        background: ${item.status === 'active' ? '#4CAF50' : 
                                                    item.status === 'pending' ? '#FF9800' : '#f44336'};
                                    ">
                                        ${item.status === 'active' ? 'Ù†Ø´Ø·' : 
                                         item.status === 'pending' ? 'Ù…Ø¹Ù„Ù‚' : 'Ù…ØªÙˆÙ‚Ù'}
                                    </span>
                                    <span>${item.price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</span>
                                </div>
                                <div class="progress-bar" style="margin-top: 10px;">
                                    <div class="progress" style="width: ${item.progress}%"></div>
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html = `
                        <div class="table-view">
                            <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                                        <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
                                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                        <th>Ø§Ù„ØªÙ‚Ø¯Ù…</th>
                                        ${this.currentUser.role !== 'viewer' ? '<th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>' : ''}
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    demoData.forEach((item, index) => {
                        html += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${item.name}</td>
                                <td>${item.service}</td>
                                <td>
                                    <span class="badge" style="
                                        background: ${item.status === 'active' ? '#4CAF50' : 
                                                    item.status === 'pending' ? '#FF9800' : '#f44336'};
                                    ">
                                        ${item.status === 'active' ? 'Ù†Ø´Ø·' : 
                                         item.status === 'pending' ? 'Ù…Ø¹Ù„Ù‚' : 'Ù…ØªÙˆÙ‚Ù'}
                                    </span>
                                </td>
                                <td>${item.price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="flex: 1;">
                                            <div class="progress-bar">
                                                <div class="progress" style="width: ${item.progress}%"></div>
                                            </div>
                                        </div>
                                        <span style="font-size: 12px; color: #666;">${item.progress}%</span>
                                    </div>
                                </td>
                                ${this.currentUser.role !== 'viewer' ? `
                                <td>
                                    <div class="action-buttons">
                                        <button class="action-btn edit touch-feedback" onclick="editItem(${item.id})">
                                            ØªØ¹Ø¯ÙŠÙ„
                                        </button>
                                        <button class="action-btn delete touch-feedback" onclick="deleteItem(${item.id})">
                                            Ø­Ø°Ù
                                        </button>
                                    </div>
                                </td>
                                ` : ''}
                            </tr>
                        `;
                    });
                    
                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                document.getElementById('dynamicView').innerHTML = html;
                this.updateStatistics();
            }

            updateStatistics() {
                const demoData = this.generateDemoData();
                
                const total = demoData.length;
                const active = demoData.filter(item => item.status === 'active').length;
                const pending = demoData.filter(item => item.status === 'pending').length;
                const revenue = demoData.reduce((sum, item) => sum + item.price, 0);
                
                document.getElementById('totalCount').textContent = total;
                document.getElementById('activeCount').textContent = active;
                document.getElementById('pendingCount').textContent = pending;
                document.getElementById('revenueCount').textContent = revenue.toLocaleString() + ' Ø¯ÙŠÙ†Ø§Ø±';
                
                // ØªØ­Ø±ÙŠÙƒ Ø£Ø´Ø±Ø·Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
                setTimeout(() => {
                    document.getElementById('totalProgress').style.width = '100%';
                    document.getElementById('activeProgress').style.width = `${(active/total)*100}%`;
                    document.getElementById('pendingProgress').style.width = `${(pending/total)*100}%`;
                    document.getElementById('revenueProgress').style.width = `${(revenue/5000000)*100}%`;
                }, 100);
            }

            renderActivityPage() {
                this.renderOnlineUsers();
                this.renderActivityLog();
                this.updateActivityStats();
            }

            renderOnlineUsers() {
                let html = '';
                
                if (this.onlineUsers.length > 0) {
                    this.onlineUsers.forEach(user => {
                        const loginTime = new Date(user.loginTime);
                        const now = new Date();
                        const diffMs = now - loginTime;
                        const diffMins = Math.floor(diffMs / 60000);
                        
                        let durationText;
                        if (diffMins < 1) {
                            durationText = 'Ø§Ù„Ø¢Ù†';
                        } else if (diffMins < 60) {
                            durationText = `${diffMins} Ø¯Ù‚ÙŠÙ‚Ø©`;
                        } else {
                            const hours = Math.floor(diffMins / 60);
                            durationText = `${hours} Ø³Ø§Ø¹Ø©`;
                        }
                        
                        html += `
                            <div class="online-user-badge touch-feedback">
                                <span class="online-indicator"></span>
                                <span>${user.name}</span>
                                <span style="font-size: 11px; opacity: 0.8;">(${this.getRoleText(user.role)})</span>
                                <span style="font-size: 10px; opacity: 0.6;">${durationText}</span>
                            </div>
                        `;
                    });
                } else {
                    html = '<p style="color: #666; text-align: center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…ØªØµÙ„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                }
                
                document.getElementById('onlineUsersList').innerHTML = html;
            }

            renderActivityLog() {
                let filteredActivities = this.activityLog;
                
                if (this.currentActivityFilter !== 'all') {
                    filteredActivities = filteredActivities.filter(activity => 
                        activity.type === this.currentActivityFilter
                    );
                }
                
                let html = '';
                
                if (filteredActivities.length > 0) {
                    filteredActivities.forEach(activity => {
                        const time = new Date(activity.timestamp);
                        const now = new Date();
                        const diffMs = now - time;
                        const diffMins = Math.floor(diffMs / 60000);
                        
                        let timeText;
                        if (diffMins < 1) {
                            timeText = 'Ø§Ù„Ø¢Ù†';
                        } else if (diffMins < 60) {
                            timeText = `Ù‚Ø¨Ù„ ${diffMins} Ø¯Ù‚ÙŠÙ‚Ø©`;
                        } else if (diffMins < 1440) {
                            const hours = Math.floor(diffMins / 60);
                            timeText = `Ù‚Ø¨Ù„ ${hours} Ø³Ø§Ø¹Ø©`;
                        } else {
                            const days = Math.floor(diffMins / 1440);
                            timeText = `Ù‚Ø¨Ù„ ${days} ÙŠÙˆÙ…`;
                        }
                        
                        let iconClass = '';
                        let icon = '';
                        switch(activity.type) {
                            case 'login':
                                iconClass = 'login';
                                icon = 'ğŸ”';
                                break;
                            case 'logout':
                                iconClass = 'logout';
                                icon = 'ğŸšª';
                                break;
                            case 'add':
                                iconClass = 'add';
                                icon = 'â•';
                                break;
                            case 'edit':
                                iconClass = 'edit';
                                icon = 'âœï¸';
                                break;
                            case 'delete':
                                iconClass = 'delete';
                                icon = 'ğŸ—‘ï¸';
                                break;
                            case 'page':
                                iconClass = 'page';
                                icon = 'ğŸ“„';
                                break;
                            default:
                                iconClass = 'page';
                                icon = 'ğŸ“';
                        }
                        
                        html += `
                            <div class="activity-item fade-in">
                                <div class="activity-icon ${iconClass}">
                                    ${icon}
                                </div>
                                <div class="activity-details">
                                    <div class="activity-user">${activity.userName}</div>
                                    <div class="activity-action">${activity.action}</div>
                                </div>
                                <div class="activity-time">
                                    ${timeText}<br>
                                    <span style="font-size: 10px;">${time.toLocaleTimeString('ar-IQ')}</span>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    html = `
                        <div style="text-align: center; padding: 40px;">
                            <div style="font-size: 48px; color: #ddd; margin-bottom: 15px;">ğŸ“</div>
                            <h4 style="color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·Ø§Øª</h4>
                            <p style="color: #999;">Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Ù†Ø´Ø§Ø·Ø§Øª Ø¨Ø¹Ø¯</p>
                        </div>
                    `;
                }
                
                document.getElementById('activityLog').innerHTML = html;
            }

            updateActivityStats() {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const lastHour = new Date(now.getTime() - 60 * 60000);
                
                const todayActivities = this.activityLog.filter(activity => 
                    new Date(activity.timestamp) >= today
                ).length;
                
                const lastHourActivities = this.activityLog.filter(activity => 
                    new Date(activity.timestamp) >= lastHour
                ).length;
                
                document.getElementById('totalUsers').textContent = this.users.length;
                document.getElementById('onlineUsers').textContent = this.onlineUsers.length;
                document.getElementById('todayActivities').textContent = todayActivities;
                document.getElementById('lastHourActivities').textContent = lastHourActivities;
            }

            filterActivity(filter) {
                this.currentActivityFilter = filter;
                document.querySelectorAll('.activity-filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll(`button[onclick="filterActivity('${filter}')"]`).forEach(btn => {
                    btn.classList.add('active');
                });
                
                this.renderActivityLog();
            }

            renderSubscribers() {
                let html = '';
                
                if (this.currentView === 'grid') {
                    html = '<div class="grid-view">';
                    this.subscribers.forEach(subscriber => {
                        html += `
                            <div class="card fade-in">
                                <h4>${subscriber.name}</h4>
                                <p style="color: #666; margin: 5px 0;">${subscriber.phone}</p>
                                <p style="color: #666; margin: 5px 0;">${subscriber.service}</p>
                                <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                                    <span class="badge" style="
                                        background: ${subscriber.status === 'active' ? '#4CAF50' : 
                                                    subscriber.status === 'pending' ? '#FF9800' : '#f44336'};
                                    ">
                                        ${subscriber.status === 'active' ? 'Ù†Ø´Ø·' : 
                                         subscriber.status === 'pending' ? 'Ù…Ø¹Ù„Ù‚' : 'Ù…ØªÙˆÙ‚Ù'}
                                    </span>
                                    <span>${subscriber.price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</span>
                                </div>
                                ${this.currentUser.role !== 'viewer' ? `
                                <div class="action-buttons" style="margin-top: 15px;">
                                    <button class="action-btn edit touch-feedback" onclick="editSubscriber(${subscriber.id})">
                                        ØªØ¹Ø¯ÙŠÙ„
                                    </button>
                                    <button class="action-btn delete touch-feedback" onclick="deleteSubscriber(${subscriber.id})">
                                        Ø­Ø°Ù
                                    </button>
                                </div>
                                ` : ''}
                            </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html = `
                        <div class="table-view">
                            <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                                        <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                                        <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                                        <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
                                        <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        ${this.currentUser.role !== 'viewer' ? '<th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>' : ''}
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    this.subscribers.forEach((subscriber, index) => {
                        html += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${subscriber.name}</td>
                                <td>${subscriber.phone}</td>
                                <td>${subscriber.email || '-'}</td>
                                <td>${subscriber.service}</td>
                                <td>${subscriber.price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</td>
                                <td>
                                    <span class="badge" style="
                                        background: ${subscriber.status === 'active' ? '#4CAF50' : 
                                                    subscriber.status === 'pending' ? '#FF9800' : '#f44336'};
                                    ">
                                        ${subscriber.status === 'active' ? 'Ù†Ø´Ø·' : 
                                         subscriber.status === 'pending' ? 'Ù…Ø¹Ù„Ù‚' : 'Ù…ØªÙˆÙ‚Ù'}
                                    </span>
                                </td>
                                ${this.currentUser.role !== 'viewer' ? `
                                <td>
                                    <div class="action-buttons">
                                        <button class="action-btn edit touch-feedback" onclick="editSubscriber(${subscriber.id})">
                                            ØªØ¹Ø¯ÙŠÙ„
                                        </button>
                                        <button class="action-btn delete touch-feedback" onclick="deleteSubscriber(${subscriber.id})">
                                            Ø­Ø°Ù
                                        </button>
                                    </div>
                                </td>
                                ` : ''}
                            </tr>
                        `;
                    });
                    
                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                if (this.subscribers.length === 0) {
                    html = `
                        <div style="text-align: center; padding: 50px;">
                            <div style="font-size: 60px; color: #ddd; margin-bottom: 20px;">ğŸ‘¥</div>
                            <h3 style="color: #666; margin-bottom: 10px;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø´ØªØ±ÙƒÙˆÙ†</h3>
                            <p style="color: #999;">Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                        </div>
                    `;
                }
                
                document.getElementById('subscribersView').innerHTML = html;
            }

            renderServices() {
                let html = '<div class="grid-view">';
                
                this.services.forEach(service => {
                    html += `
                        <div class="card fade-in">
                            <h4>${service.name}</h4>
                            <p style="color: #666; margin: 10px 0;">Ø§Ù„ÙØ¦Ø©: ${service.category}</p>
                            <p style="color: #666; margin: 10px 0;">${service.description || ''}</p>
                            <p style="color: var(--primary); font-weight: bold; font-size: 18px;">
                                ${service.priceRange} Ø¯ÙŠÙ†Ø§Ø±
                            </p>
                            ${this.currentUser.role !== 'viewer' ? `
                            <div class="action-buttons" style="margin-top: 15px;">
                                <button class="action-btn edit touch-feedback" onclick="editService(${service.id})">
                                    ØªØ¹Ø¯ÙŠÙ„
                                </button>
                                <button class="action-btn delete touch-feedback" onclick="deleteService(${service.id})">
                                    Ø­Ø°Ù
                                </button>
                            </div>
                            ` : ''}
                        </div>
                    `;
                });
                
                html += '</div>';
                document.getElementById('servicesView').innerHTML = html;
            }

            renderUsers() {
                if (this.currentUser.role !== 'admin') {
                    document.getElementById('usersView').innerHTML = `
                        <div style="text-align: center; padding: 50px;">
                            <div style="font-size: 60px; color: #ddd; margin-bottom: 20px;">ğŸš«</div>
                            <h3 style="color: #666; margin-bottom: 10px;">ØºÙŠØ± Ù…ØµØ±Ø­</h3>
                            <p style="color: #999;">Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '<div class="users-grid">';
                
                this.users.forEach(user => {
                    const roleClass = `role-${user.role}`;
                    html += `
                        <div class="user-card fade-in">
                            <h4>${user.fullName}</h4>
                            <p style="color: #666; margin: 5px 0;">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${user.username}</p>
                            <p style="color: #666; margin: 5px 0;">Ø§Ù„Ø¨Ø±ÙŠØ¯: ${user.email || '-'}</p>
                            <span class="user-role ${roleClass}">${this.getRoleText(user.role)}</span>
                            <div class="action-buttons" style="margin-top: 15px;">
                                <button class="action-btn edit touch-feedback" onclick="editUser(${user.id})">
                                    ØªØ¹Ø¯ÙŠÙ„
                                </button>
                                ${user.id !== this.currentUser.id ? `
                                <button class="action-btn delete touch-feedback" onclick="deleteUser(${user.id})">
                                    Ø­Ø°Ù
                                </button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                document.getElementById('usersView').innerHTML = html;
            }

            renderFinancial() {
                const months = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'];
                const revenueData = months.map(month => ({
                    month,
                    revenue: Math.floor(Math.random() * 5000000) + 1000000,
                    expenses: Math.floor(Math.random() * 2000000) + 500000,
                    profit: 0
                }));
                
                revenueData.forEach(item => {
                    item.profit = item.revenue - item.expenses;
                });
                
                const totalRevenue = revenueData.reduce((sum, item) => sum + item.revenue, 0);
                const totalExpenses = revenueData.reduce((sum, item) => sum + item.expenses, 0);
                const totalProfit = totalRevenue - totalExpenses;
                
                let html = `
                    <div class="stats-grid">
                        <div class="stat-card revenue">
                            <div style="font-size: 24px; color: var(--success); margin-bottom: 10px;">ğŸ’°</div>
                            <div class="stat-value">${totalRevenue.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</div>
                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                        </div>
                        
                        <div class="stat-card pending">
                            <div style="font-size: 24px; color: var(--warning); margin-bottom: 10px;">ğŸ’¸</div>
                            <div class="stat-value">${totalExpenses.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</div>
                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                        </div>
                        
                        <div class="stat-card active">
                            <div style="font-size: 24px; color: var(--secondary); margin-bottom: 10px;">ğŸ“ˆ</div>
                            <div class="stat-value">${totalProfit.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</div>
                            <div class="stat-label">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
                        </div>
                    </div>
                    
                    <div class="table-view" style="margin-top: 30px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Ø§Ù„Ø´Ù‡Ø±</th>
                                    <th>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</th>
                                    <th>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</th>
                                    <th>Ø§Ù„Ø±Ø¨Ø­</th>
                                    <th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                revenueData.forEach(item => {
                    const profitPercentage = ((item.profit / item.revenue) * 100).toFixed(1);
                    html += `
                        <tr>
                            <td>${item.month}</td>
                            <td>${item.revenue.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</td>
                            <td>${item.expenses.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</td>
                            <td style="color: ${item.profit >= 0 ? 'var(--success)' : 'var(--danger)'};">
                                ${item.profit.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±
                            </td>
                            <td>
                                <span class="badge" style="
                                    background: ${item.profit >= 0 ? '#4CAF50' : '#f44336'};
                                ">
                                    ${profitPercentage}%
                                </span>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                document.getElementById('financialView').innerHTML = html;
            }

            renderSettings() {
                document.getElementById('autoRefresh').checked = this.settings.autoRefresh;
                document.getElementById('notifications').checked = this.settings.notifications;
                document.getElementById('logActivities').checked = this.settings.logActivities;
            }

            openAddModal(subscriber = null) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø¥Ø¶Ø§ÙØ© Ù…Ø´ØªØ±ÙƒÙŠÙ†', 'error');
                    return;
                }
                
                this.editingId = subscriber ? subscriber.id : null;
                
                if (subscriber) {
                    document.getElementById('modalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ù…Ø´ØªØ±Ùƒ';
                    document.getElementById('nameInput').value = subscriber.name;
                    document.getElementById('phoneInput').value = subscriber.phone;
                    document.getElementById('emailInput').value = subscriber.email || '';
                    document.getElementById('priceInput').value = subscriber.price;
                    document.getElementById('notesInput').value = subscriber.notes || '';
                    document.getElementById('statusInput').value = subscriber.status;
                } else {
                    document.getElementById('modalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…Ø´ØªØ±Ùƒ Ø¬Ø¯ÙŠØ¯';
                    document.getElementById('nameInput').value = '';
                    document.getElementById('phoneInput').value = '';
                    document.getElementById('emailInput').value = '';
                    document.getElementById('priceInput').value = '';
                    document.getElementById('notesInput').value = '';
                    document.getElementById('statusInput').value = 'active';
                }
                
                // ØªØ¹Ø¨Ø¦Ø© Ø®Ø¯Ù…Ø§Øª
                const serviceSelect = document.getElementById('serviceInput');
                serviceSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø©</option>';
                this.services.forEach(service => {
                    const option = document.createElement('option');
                    option.value = service.name;
                    option.textContent = service.name;
                    if (subscriber && subscriber.service === service.name) {
                        option.selected = true;
                    }
                    serviceSelect.appendChild(option);
                });
                
                // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª
                const governorates = [
                    'Ø¨ØºØ¯Ø§Ø¯', 'Ø§Ù„Ø¨ØµØ±Ø©', 'Ù†ÙŠÙ†ÙˆÙ‰', 'Ø£Ø±Ø¨ÙŠÙ„', 'Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©', 'Ø°ÙŠ Ù‚Ø§Ø±',
                    'Ø§Ù„Ù…Ø«Ù†Ù‰', 'Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ©', 'Ø¨Ø§Ø¨Ù„', 'ÙƒØ±Ø¨Ù„Ø§Ø¡', 'Ø§Ù„Ù†Ø¬Ù', 'Ø§Ù„Ø£Ù†Ø¨Ø§Ø±',
                    'Ø¯ÙŠØ§Ù„Ù‰', 'ÙˆØ§Ø³Ø·', 'ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†', 'ÙƒØ±ÙƒÙˆÙƒ', 'Ø¯Ù‡ÙˆÙƒ'
                ];
                
                const governorateSelect = document.getElementById('governorateInput');
                governorateSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>';
                governorates.forEach(gov => {
                    const option = document.createElement('option');
                    option.value = gov;
                    option.textContent = gov;
                    if (subscriber && subscriber.governorate === gov) {
                        option.selected = true;
                    }
                    governorateSelect.appendChild(option);
                });
                
                document.getElementById('addModal').style.display = 'flex';
            }

            saveSubscriber() {
                const subscriber = {
                    id: this.editingId || Date.now(),
                    name: document.getElementById('nameInput').value.trim(),
                    phone: document.getElementById('phoneInput').value.trim(),
                    email: document.getElementById('emailInput').value.trim(),
                    service: document.getElementById('serviceInput').value,
                    price: parseInt(document.getElementById('priceInput').value) || 0,
                    governorate: document.getElementById('governorateInput').value,
                    status: document.getElementById('statusInput').value,
                    notes: document.getElementById('notesInput').value.trim(),
                    date: new Date().toLocaleDateString('ar-IQ'),
                    createdBy: this.currentUser.id
                };
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                if (!subscriber.name || !subscriber.phone || !subscriber.service) {
                    this.showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                    return;
                }
                
                const actionType = this.editingId ? 'edit' : 'add';
                const actionText = this.editingId ? 'ØªØ¹Ø¯ÙŠÙ„' : 'Ø¥Ø¶Ø§ÙØ©';
                
                if (this.editingId) {
                    const index = this.subscribers.findIndex(s => s.id === this.editingId);
                    if (index !== -1) {
                        subscriber.createdBy = this.subscribers[index].createdBy;
                        this.subscribers[index] = subscriber;
                    }
                } else {
                    this.subscribers.push(subscriber);
                }
                
                this.saveData('subscribers', this.subscribers);
                
                this.logActivity(actionType, 
                    `${this.currentUser.fullName} Ù‚Ø§Ù… Ø¨${actionText} Ù…Ø´ØªØ±Ùƒ Ø¬Ø¯ÙŠØ¯: ${subscriber.name}`,
                    { subscriberId: subscriber.id, name: subscriber.name, price: subscriber.price }
                );
                
                this.closeModal();
                this.renderSubscribers();
                this.updateStatistics();
                this.showMessage(
                    this.editingId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø¨Ù†Ø¬Ø§Ø­',
                    'success'
                );
            }

            editSubscriber(id) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„', 'error');
                    return;
                }
                
                const subscriber = this.subscribers.find(s => s.id === id);
                if (subscriber) {
                    this.openAddModal(subscriber);
                }
            }

            deleteSubscriber(id) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø­Ø°Ù', 'error');
                    return;
                }
                
                const subscriber = this.subscribers.find(s => s.id === id);
                
                if (subscriber && confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´ØªØ±ÙƒØŸ')) {
                    this.subscribers = this.subscribers.filter(s => s.id !== id);
                    this.saveData('subscribers', this.subscribers);
                    
                    this.logActivity('delete',
                        `${this.currentUser.fullName} Ù‚Ø§Ù… Ø¨Ø­Ø°Ù Ù…Ø´ØªØ±Ùƒ: ${subscriber.name}`,
                        { subscriberId: id, name: subscriber.name }
                    );
                    
                    this.renderSubscribers();
                    this.updateStatistics();
                    this.showMessage('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            }

            editItem(id) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„', 'error');
                    return;
                }
                
                const item = this.generateDemoData().find(item => item.id === id);
                if (item) {
                    this.showMessage(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù†ØµØ±: ${item.name}`, 'info');
                }
            }

            deleteItem(id) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø­Ø°Ù', 'error');
                    return;
                }
                
                const item = this.generateDemoData().find(item => item.id === id);
                if (item && confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ±ØŸ')) {
                    this.showMessage(`ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ±: ${item.name}`, 'success');
                }
            }

            editService(id) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„', 'error');
                    return;
                }
                
                const service = this.services.find(s => s.id === id);
                if (service) {
                    this.openServiceModal(service);
                }
            }

            deleteService(id) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø­Ø°Ù', 'error');
                    return;
                }
                
                const service = this.services.find(s => s.id === id);
                if (service && confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ')) {
                    this.services = this.services.filter(s => s.id !== id);
                    this.saveData('services', this.services);
                    
                    this.logActivity('delete',
                        `${this.currentUser.fullName} Ù‚Ø§Ù… Ø¨Ø­Ø°Ù Ø®Ø¯Ù…Ø©: ${service.name}`,
                        { serviceId: id, name: service.name }
                    );
                    
                    this.renderServices();
                    this.showMessage('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            }

            openServiceModal(service = null) {
                if (this.currentUser.role === 'viewer') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø§Øª', 'error');
                    return;
                }
                
                this.editingId = service ? service.id : null;
                
                if (service) {
                    document.getElementById('serviceModalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø®Ø¯Ù…Ø©';
                    document.getElementById('serviceNameInput').value = service.name;
                    document.getElementById('serviceCategoryInput').value = service.category;
                    
                    if (service.priceRange) {
                        const prices = service.priceRange.split(' - ');
                        if (prices.length === 2) {
                            document.getElementById('serviceMinPrice').value = prices[0].replace(/[^0-9]/g, '');
                            document.getElementById('serviceMaxPrice').value = prices[1].replace(/[^0-9]/g, '');
                        }
                    }
                    
                    document.getElementById('serviceDescription').value = service.description || '';
                } else {
                    document.getElementById('serviceModalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©';
                    document.getElementById('serviceNameInput').value = '';
                    document.getElementById('serviceCategoryInput').value = '';
                    document.getElementById('serviceMinPrice').value = '';
                    document.getElementById('serviceMaxPrice').value = '';
                    document.getElementById('serviceDescription').value = '';
                }
                
                document.getElementById('serviceModal').style.display = 'flex';
            }

            saveService() {
                const service = {
                    id: this.editingId || Date.now(),
                    name: document.getElementById('serviceNameInput').value.trim(),
                    category: document.getElementById('serviceCategoryInput').value,
                    priceRange: `${document.getElementById('serviceMinPrice').value} - ${document.getElementById('serviceMaxPrice').value}`,
                    description: document.getElementById('serviceDescription').value.trim()
                };
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                if (!service.name || !service.category) {
                    this.showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                    return;
                }
                
                const actionType = this.editingId ? 'edit' : 'add';
                const actionText = this.editingId ? 'ØªØ¹Ø¯ÙŠÙ„' : 'Ø¥Ø¶Ø§ÙØ©';
                
                if (this.editingId) {
                    const index = this.services.findIndex(s => s.id === this.editingId);
                    if (index !== -1) {
                        this.services[index] = service;
                    }
                } else {
                    this.services.push(service);
                }
                
                this.saveData('services', this.services);
                
                this.logActivity(actionType,
                    `${this.currentUser.fullName} Ù‚Ø§Ù… Ø¨${actionText} Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©: ${service.name}`,
                    { serviceId: service.id, name: service.name }
                );
                
                this.closeServiceModal();
                this.renderServices();
                this.showMessage(
                    this.editingId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­',
                    'success'
                );
            }

            closeServiceModal() {
                document.getElementById('serviceModal').style.display = 'none';
                this.editingId = null;
            }

            openUserModal(user = null) {
                if (this.currentUser.role !== 'admin') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', 'error');
                    return;
                }
                
                this.editingId = user ? user.id : null;
                
                if (user) {
                    document.getElementById('userModalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…';
                    document.getElementById('userNameInput').value = user.username;
                    document.getElementById('userPasswordInput').value = '';
                    document.getElementById('userFullNameInput').value = user.fullName;
                    document.getElementById('userRoleInput').value = user.role;
                    document.getElementById('userEmailInput').value = user.email || '';
                } else {
                    document.getElementById('userModalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯';
                    document.getElementById('userNameInput').value = '';
                    document.getElementById('userPasswordInput').value = '';
                    document.getElementById('userFullNameInput').value = '';
                    document.getElementById('userRoleInput').value = 'editor';
                    document.getElementById('userEmailInput').value = '';
                }
                
                document.getElementById('userModal').style.display = 'flex';
            }

            saveUser() {
                const user = {
                    id: this.editingId || Date.now(),
                    username: document.getElementById('userNameInput').value.trim(),
                    password: document.getElementById('userPasswordInput').value || 'password123',
                    fullName: document.getElementById('userFullNameInput').value.trim(),
                    role: document.getElementById('userRoleInput').value,
                    email: document.getElementById('userEmailInput').value.trim(),
                    created: new Date().toISOString()
                };
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                if (!user.username || !user.fullName) {
                    this.showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                    return;
                }
                
                if (!this.editingId) {
                    const exists = this.users.some(u => u.username.toLowerCase() === user.username.toLowerCase());
                    if (exists) {
                        this.showMessage('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„', 'error');
                        return;
                    }
                }
                
                if (this.editingId) {
                    const index = this.users.findIndex(u => u.id === this.editingId);
                    if (index !== -1) {
                        if (!user.password) {
                            user.password = this.users[index].password;
                        }
                        this.users[index] = user;
                        
                        if (user.id === this.currentUser.id) {
                            this.currentUser = user;
                            try {
                                localStorage.setItem('currentUser', JSON.stringify(user));
                            } catch (e) {
                                console.error('Error updating session:', e);
                            }
                            document.getElementById('currentUser').textContent = user.fullName;
                            document.getElementById('currentRole').textContent = this.getRoleText(user.role);
                            this.checkPermissions();
                        }
                    }
                } else {
                    this.users.push(user);
                }
                
                this.saveData('users', this.users);
                
                this.closeUserModal();
                this.renderUsers();
                this.showMessage(
                    this.editingId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­',
                    'success'
                );
            }

            editUser(id) {
                if (this.currentUser.role !== 'admin') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„', 'error');
                    return;
                }
                
                const user = this.users.find(u => u.id === id);
                if (user) {
                    this.openUserModal(user);
                }
            }

            deleteUser(id) {
                if (this.currentUser.role !== 'admin') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø­Ø°Ù', 'error');
                    return;
                }
                
                if (id === this.currentUser.id) {
                    this.showMessage('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø®Ø§Øµ', 'error');
                    return;
                }
                
                const user = this.users.find(u => u.id === id);
                if (user && confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                    this.users = this.users.filter(u => u.id !== id);
                    this.saveData('users', this.users);
                    
                    this.logActivity('delete',
                        `${this.currentUser.fullName} Ù‚Ø§Ù… Ø¨Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù…: ${user.fullName}`,
                        { userId: id, name: user.fullName }
                    );
                    
                    this.renderUsers();
                    this.showMessage('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            }

            closeModal() {
                document.getElementById('addModal').style.display = 'none';
                this.editingId = null;
            }

            closeUserModal() {
                document.getElementById('userModal').style.display = 'none';
                this.editingId = null;
            }

            setViewMode(mode) {
                this.currentView = mode;
                document.querySelectorAll('.control-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll(`button[onclick="setViewMode('${mode}')"]`).forEach(btn => {
                    btn.classList.add('active');
                });
                
                this.renderAll();
            }

            performSearch(query) {
                if (query.length > 0) {
                    this.showMessage(`Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: ${query}`, 'info');
                }
            }

            filterData(filter) {
                this.currentFilter = filter;
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll(`button[onclick="filterData('${filter}')"]`).forEach(btn => {
                    btn.classList.add('active');
                });
                
                this.showMessage(`ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±: ${filter}`, 'info');
            }

            updateDate() {
                const now = new Date();
                const options = { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                };
                document.getElementById('currentDate').textContent = 
                    now.toLocaleDateString('ar-IQ', options);
            }

            updateOnlineStatus() {
                const isOnline = navigator.onLine;
                const statusElement = document.getElementById('onlineStatus');
                
                if (isOnline) {
                    statusElement.innerHTML = `
                        <span style="width: 10px; height: 10px; background: var(--success); border-radius: 50%; animation: pulse 2s infinite;"></span>
                        <span>Ù…ØªØµÙ„</span>
                    `;
                    statusElement.style.color = 'var(--success)';
                    this.showMessage('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª', 'success');
                } else {
                    statusElement.innerHTML = `
                        <span style="width: 10px; height: 10px; background: var(--danger); border-radius: 50%;"></span>
                        <span>ØºÙŠØ± Ù…ØªØµÙ„</span>
                    `;
                    statusElement.style.color = 'var(--danger)';
                    this.showMessage('ÙÙ‚Ø¯Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª', 'warning');
                }
            }

            changeTheme(theme) {
                this.currentTheme = theme;
                this.applyTheme();
                this.showMessage(`ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ… Ø¥Ù„Ù‰ ${theme}`, 'success');
                
                this.settings.theme = theme;
                this.saveData('settings', this.settings);
            }

            applyTheme() {
                const themes = {
                    blue: { primary: '#1a2980', secondary: '#26d0ce' },
                    green: { primary: '#2E7D32', secondary: '#4CAF50' },
                    purple: { primary: '#6A1B9A', secondary: '#9C27B0' },
                    dark: { primary: '#212121', secondary: '#424242' }
                };
                
                const theme = themes[this.currentTheme];
                document.documentElement.style.setProperty('--primary', theme.primary);
                document.documentElement.style.setProperty('--secondary', theme.secondary);
            }

            saveSetting(key, value) {
                this.settings[key] = value;
                this.saveData('settings', this.settings);
                this.showMessage('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'success');
            }

            backupData() {
                const data = {
                    users: this.users,
                    subscribers: this.subscribers,
                    services: this.services,
                    settings: this.settings,
                    financial: this.financialData,
                    activityLog: this.activityLog,
                    backupDate: new Date().toISOString(),
                    system: 'Ø¹Ø±Ø§Ù‚ Ø³ØªØ§Ø±'
                };
                
                try {
                    const dataStr = JSON.stringify(data, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `Ø¹Ø±Ø§Ù‚-Ø³ØªØ§Ø±-Ù†Ø³Ø®Ø©-Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©-${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    this.showMessage('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'success');
                } catch (error) {
                    this.showMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'error');
                }
            }

            restoreData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                
                input.onchange = e => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    const reader = new FileReader();
                    
                    reader.onload = event => {
                        try {
                            const data = JSON.parse(event.target.result);
                            
                            if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©ØŸ Ø³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')) {
                                return;
                            }
                            
                            this.users = data.users || this.getDefaultUsers();
                            this.subscribers = data.subscribers || [];
                            this.services = data.services || this.getDefaultServices();
                            this.settings = data.settings || this.getDefaultSettings();
                            this.financialData = data.financial || [];
                            this.activityLog = data.activityLog || [];
                            this.onlineUsers = [];
                            
                            this.saveData('users', this.users);
                            this.saveData('subscribers', this.subscribers);
                            this.saveData('services', this.services);
                            this.saveData('settings', this.settings);
                            this.saveData('financial', this.financialData);
                            this.saveData('activityLog', this.activityLog);
                            this.saveData('onlineUsers', this.onlineUsers);
                            
                            this.showMessage('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                            setTimeout(() => {
                                location.reload();
                            }, 2000);
                        } catch (error) {
                            this.showMessage('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ø£Ùˆ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­', 'error');
                        }
                    };
                    
                    reader.readAsText(file);
                };
                
                input.click();
            }

            exportActivityLog() {
                if (this.currentUser.role !== 'admin') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØµØ¯ÙŠØ±', 'error');
                    return;
                }
                
                try {
                    const data = {
                        exportDate: new Date().toISOString(),
                        totalActivities: this.activityLog.length,
                        system: 'Ø¹Ø±Ø§Ù‚ Ø³ØªØ§Ø±',
                        activities: this.activityLog
                    };
                    
                    const dataStr = JSON.stringify(data, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `Ø³Ø¬Ù„-Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª-${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    this.showMessage('ØªÙ… ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª', 'success');
                } catch (error) {
                    this.showMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØµØ¯ÙŠØ±', 'error');
                }
            }

            clearOldActivities() {
                if (this.currentUser.role !== 'admin') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø³Ø­', 'error');
                    return;
                }
                
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©ØŸ Ø³ÙŠØªÙ… Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ ÙÙ‚Ø· Ø¨Ù†Ø´Ø§Ø·Ø§Øª Ø¢Ø®Ø± 30 ÙŠÙˆÙ….')) {
                    const thirtyDaysAgo = new Date();
                    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                    
                    this.activityLog = this.activityLog.filter(activity => 
                        new Date(activity.timestamp) >= thirtyDaysAgo
                    );
                    
                    this.saveData('activityLog', this.activityLog);
                    this.renderActivityLog();
                    this.updateActivityStats();
                    this.showMessage('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©', 'success');
                }
            }

            renderAll() {
                if (!this.currentUser) return;
                
                this.updateDate();
                this.updateOnlineStatus();
                this.updateStatistics();
                this.updateLoginTimeDisplay();
                
                const currentPage = document.querySelector('.page.active').id.replace('Page', '');
                switch(currentPage) {
                    case 'dashboard':
                        this.renderDashboard();
                        break;
                    case 'activity':
                        this.renderActivityPage();
                        break;
                    case 'subscribers':
                        this.renderSubscribers();
                        break;
                    case 'services':
                        this.renderServices();
                        break;
                    case 'financial':
                        this.renderFinancial();
                        break;
                    case 'users':
                        this.renderUsers();
                        break;
                    case 'settings':
                        this.renderSettings();
                        break;
                }
            }

            showMessage(message, type = 'info') {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                document.querySelectorAll('.alert-message').forEach(msg => msg.remove());
                
                const colors = {
                    success: '#4CAF50',
                    error: '#f44336',
                    warning: '#FF9800',
                    info: '#2196F3'
                };
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'alert-message';
                messageDiv.textContent = message;
                messageDiv.style.background = colors[type] || colors.info;
                
                document.body.appendChild(messageDiv);
                
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.style.opacity = '0';
                        messageDiv.style.transform = 'translateX(-100%)';
                        setTimeout(() => {
                            if (messageDiv.parentNode) {
                                messageDiv.remove();
                            }
                        }, 300);
                    }
                }, 3000);
            }

            exportAllData() {
                if (this.currentUser.role !== 'admin') {
                    this.showMessage('Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØµØ¯ÙŠØ±', 'error');
                    return;
                }
                
                this.backupData();
            }

            refreshData() {
                this.renderAll();
                this.showMessage('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        const dynamicManager = new DynamicManager();

        // Ø¯ÙˆØ§Ù„ Ø¹Ø§Ù…Ø© Ù„Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ù† HTML
        function setViewMode(mode) {
            dynamicManager.setViewMode(mode);
        }

        function filterData(filter) {
            dynamicManager.filterData(filter);
        }

        function refreshData() {
            dynamicManager.refreshData();
        }

        function exportAllData() {
            dynamicManager.exportAllData();
        }

        function openAddModal() {
            dynamicManager.openAddModal();
        }

        function closeModal() {
            dynamicManager.closeModal();
        }

        function changeTheme(theme) {
            dynamicManager.changeTheme(theme);
        }

        function openServiceModal() {
            dynamicManager.openServiceModal();
        }

        function closeServiceModal() {
            dynamicManager.closeServiceModal();
        }

        function openUserModal() {
            dynamicManager.openUserModal();
        }

        function closeUserModal() {
            dynamicManager.closeUserModal();
        }

        function saveSetting(key, value) {
            dynamicManager.saveSetting(key, value);
        }

        function backupData() {
            dynamicManager.backupData();
        }

        function restoreData() {
            dynamicManager.restoreData();
        }

        function performSearch(query) {
            dynamicManager.performSearch(query);
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
        function filterActivity(filter) {
            dynamicManager.filterActivity(filter);
        }

        function exportActivityLog() {
            dynamicManager.exportActivityLog();
        }

        function clearOldActivities() {
            dynamicManager.clearOldActivities();
        }

        function editItem(id) {
            dynamicManager.editItem(id);
        }

        function deleteItem(id) {
            dynamicManager.deleteItem(id);
        }

        function editSubscriber(id) {
            dynamicManager.editSubscriber(id);
        }

        function deleteSubscriber(id) {
            dynamicManager.deleteSubscriber(id);
        }

        function editService(id) {
            dynamicManager.editService(id);
        }

        function deleteService(id) {
            dynamicManager.deleteService(id);
        }

        function editUser(id) {
            dynamicManager.editUser(id);
        }

        function deleteUser(id) {
            dynamicManager.deleteUser(id);
        }

        // ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                document.getElementById('sidebar').classList.remove('active');
            }
        });

        // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù„Ù…Ø³ Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
        if ('ontouchstart' in window) {
            document.body.classList.add('touch-device');
        }
    </script>
</body>
</html>